//tealium universal tag - utag.42 ut4.0.202402201042, Copyright 2024 Tealium.com Inc. All Rights Reserved.
(function(p,l){if(!p[l]){p.nukSnowplowNamespace=p.nukSnowplowNamespace||[];p.nukSnowplowNamespace.push(l);p[l]=function(){(p[l].q=p[l].q||[]).push(arguments)};p[l].q=p[l].q||[];}}(window,"nukNewsIdSnowplow"));try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':1,'link':1};u.initialized=false;u.spTrackerCreated=false;u.map={"trk_baseURL":"trk_baseURL","trk_namespace":"trk_namespace","trk_endpoint":"trk_endpoint","trk_appId":"trk_appId","trk_sendAsPost":"trk_sendAsPost","trk_cookieDomain":"trk_cookieDomain","trk_cookieName":"trk_cookieName","trk_cookieLifetime":"trk_cookieLifetime","trk_platform":"trk_platform","trk_encodeBase64":"trk_encodeBase64","trk_respectDoNotTrack":"trk_respectDoNotTrack","trk_bufferSize":"trk_bufferSize","trk_storageStrategy":"trk_storageStrategy","trk_customPageURL":"trk_customPageURL","trk_customPageTitle":"trk_customPageTitle","article_id":"c.a.article_id,c.n.article_id","article_source":"c.a.article_source","article_publish_timestamp":"c.a.article_published_time,c.n.article_publish_timestamp","page_type":"c.a.content_type,c.n.page_type","page_section":"c.a.section,c.n.section_level_1","page_section_2":"c.a.subsection,c.n.section_level_2","page_section_3":"c.a.subsubsection,c.n.section_level_3","page_section_4":"c.a.subsubsubsection","page_restrictions":"c.a.article_paid_content_type","customer_id":"c.k.user_id,c.n.customer_id","user_provider":"c.k.user_provider","customer_type":"c.k.user_memtype","newsletter_id":"c.k.user_newsletter_id","newsletter_provider":"c.k.user_newsletter_provider","dmp_id":"c.k.browser_dmp_id","dmp_provider":"c.k.browser_dmp_provider","ads_ppid":"c.k.browser_ads_ppid","ads_provider":"c.k.browser_ads_provider","analytics_id":"c.k.browser_analytics_id","analytics_provider":"c.k.browser_analytics_provider","_ncg_g_id_":"c.k.browser_ncg_id","sync_vis_id":"c.n.synced_visitor_id","sync_vis_provider":"c.n.synced_visitor_provider","pageViewId":"c.n.page_view_id","consentFlags":"c.n.user_consent_flags","nukpNetwork":"c.n.network","nukpPublication":"c.n.publication","parent_site":"c.n.parent_site","page_site_name":"c.n.platform","cms_original_publishing_site":"c.n.cms_original_publishing_site","page_name":"c.n.page_name","page_section_id":"c.n.section_id_level_1","page_section_2_id":"c.n.section_id_level_2","page_section_3_id":"c.n.section_id_level_3","page_tags":"c.n.page_tags","nukpPageAdd1":"c.n.page_additional_1","nukpPageAdd2":"c.n.page_additional_2","nukpPageAdd3":"c.n.page_additional_3","nukpPageAdd4":"c.n.page_additional_4","previous_page_name":"c.n.previous_page_name","nuk_referer":"c.n.referrer_url","article_id_last_viewed":"c.n.article_id_last_viewed","article_name":"c.n.article_headline","article_name_latest":"c.n.article_headline_latest","article_author":"c.n.article_author","article_kicker_name":"c.n.article_kicker","article_tag_name":"c.n.article_tag","article_template_name":"c.n.article_template_name","article_locked_status":"c.n.article_locked_status","article_topic_tags":"c.n.article_topic_tags","article_flag":"c.n.article_flag","registration_type":"c.n.registration_type","propensity_user_type":"c.n.propensity_user_type","nukpAppUUID":"c.n.app_uuid","nukpUserInteractionName":"c.n.event_name","nukpUserInteractionMethod":"c.n.event_method","nukpUserInteractionAdd1":"c.n.event_additional_1","nukpUserInteractionAdd2":"c.n.event_additional_2","nukpUserInteractionAdd3":"c.n.event_additional_3","nukpUserInteractionAdd4":"c.n.event_additional_4","widget_headline":"c.n.teaser_headline","widget_kicker":"c.n.teaser_kicker","widget_tag":"c.n.teaser_tag","teaser_lead_text":"c.n.teaser_lead_text","teaser_image_url":"c.n.teaser_image_url","splash_teaser_name":"c.n.teaser_splash_name","teaser_image_visible":"c.n.teaser_image_visible","teaser_lead_text_visible":"c.n.teaser_lead_text_visible","widget_type":"c.n.teaser_type","widget_section":"c.n.teaser_section","social_platform":"c.n.social_platform","internal_search_term":"c.n.internal_search_term","question_type":"c.n.question_type","nukpNonInteraction":"c.n.non_interaction_flag","media_id":"c.n.media_id","media_type":"c.n.media_type","media_name":"c.n.media_name","media_player":"c.n.media_player","media_duration":"c.n.media_duration","media_offset":"c.n.media_offset","media_milestone":"c.n.media_milestone","media_segment":"c.n.media_segment","media_position":"c.n.media_position","media_show":"c.n.media_show","optimizely_experiment_data":"c.n.optimizely_experiment_data","experiment_details":"c.n.experiment_details","optimizely_full_stack":"c.n.optimizely_full_stack","tpw_free_articles_viewed":"c.n.tpw_free_articles_viewed","tpw_free_articles_left":"c.n.tpw_free_articles_left","tpw_blocked_articles_viewed":"c.n.tpw_blocked_articles_viewed","tpw_user_lifetime_articles_viewed":"c.n.tpw_user_lifetime_articles_viewed","tpw_month_count":"c.n.tpw_month_count","tpw_article_access_type":"c.n.tpw_article_access_type","tpw_experiment_id_and_variant":"c.n.tpw_experiment_id_and_variant","tpw_views_remaining":"c.n.tpw_views_remaining","tpw_views_allowed":"c.n.tpw_views_allowed","tpw_zephr_status":"c.n.tpw_zephr_status","all_access_reasons":"c.n.tpw_zephr_all_access_reasons","mp_code":"c.n.mp_code","pc_code":"c.n.pc_code","product_name":"c.n.product_name","orientation":"c.n.device_orientation","nuk_screen_info":"c.n.device_screen_info","nukpOsVersion":"c.n.device_os_version","nukpAppVersion":"c.n.app_version","cp.utag_main_v_id":"c.n.tealium_visitor_id","cp.utag_main_ses_id":"c.n.tealium_session_id","nukpSessionNumber":"c.n.tealium_session_number","time_timestamp":"c.n.timestamp_label","cs_timestamp":"c.n.timestamp","user_time_zone":"c.n.user_timezone","module_id":"c.n.module_id","nukpEventCategory":"trk_EventCategory","nukpEventAction":"trk_EventAction","nukpEventLabel":"trk_EventLabel","nukpEventProperty":"trk_EventProperty","consentNewsIdData":"consentData"};u.extend=[function(a,b){try{if(1){if(b.customer_id){b.customer_id=b.customer_id.toUpperCase().replace('CPN:','');}
b.customer_id_with_type=b.customer_id_with_type||b.customer_id||"";b.previous_page_name="";b.previous_page_section="";b.previous_page_type="";}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(a&&a==="link"&&b.event_action&&b.event_action!==""){b.nukpUserInteractionName=(b.event_action||"").toLowerCase();if(b.question_type&&b.question_type!==""){if(b.event_action.toLowerCase()==="question displayed"||b.event_action.toLowerCase()==="question answered"||b.event_action.toLowerCase()==="question stats"){b.nukpUserInteractionName=b.nukpUserInteractionName+" ("+b.question_type.toLowerCase()+")";}}
if(b.event_action.toLowerCase().indexOf("sim module")===-1){b.nukpUserInteractionAdd1=(b.question_text||"").toLowerCase();b.nukpUserInteractionAdd2=(b.answer_text||"").toLowerCase();b.nukpUserInteractionAdd3=(b.newsiq_poe_code||"").toLowerCase();b.nukpUserInteractionAdd4=(b.final_page_name||"").toLowerCase();b.nukpEventCategory="poll widget events";}else{b.nukpEventCategory="sim module events";}
b.nukpEventAction=b.nukpUserInteractionName;}
if(a&&a==="link"&&b.event_action&&b.event_action!==""){if(b.user_gender&&b.user_age){b.nukpUserInteractionAdd4=b.user_gender+'|'+b.user_age;}}
if(a&&a==="link"&&b.event_action&&b.event_action!==""){if(b.palin_poll_id){b.nukpUserInteractionAdd4=b.palin_poll_id;}}
if(a&&a==="link"&&b.event_action&&b.event_action!==""){if(b.cms_content_group&&b.poll_question_channel){b.nukpPageAdd3=b.cms_content_group+'|'+b.poll_question_channel;}
else if(b.cms_content_group||typeof(poll_question_channel)==='undefined'||poll_question_channel===""){b.nukpPageAdd3=b.cms_content_group;}}
if(a&&a==="link"&&b.event_action&&b.event_action!==""){if(b.comp_details){b.nukpPageAdd1=b.comp_details;}}
if(a&&a==="link"&&b.event_action&&b.event_action!==""){if(b.article_url){b.nukpPageAdd4=b.article_url;}}
if(a&&a==="link"&&b.event_action&&b.event_action!==""){if(b.article_parent_name){b.nukpPageAdd2=b.article_parent_name;}}
if(a&&a==="link"&&b.final_page_name&&b.final_page_name!==""){if(b.article_parent_name){b.nukpPageAdd2=b.article_parent_name+" : "+b.final_page_name;}}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(a&&a==="link"&&b.customRegistrationFlag&&b.customRegistrationFlag==="true"){b.nukpEventCategory="registration and subscription events";b.nukpEventAction="registration";b.nukpEventAction="the sun generic widgets competition";}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){b.trk_baseURL='https://nid.staging-thesun.co.uk/prod/sp/nid_sp.js';if(b.tealium_environment&&b.tealium_environment.toLowerCase()==='prod'){b.trk_baseURL='https://nid.thesun.co.uk/prod/sp/nid_sp.js';}
b.trk_endpoint='https://v2.pixel.nukd.data.newscorp.com';if(b.tealium_environment&&b.tealium_environment.toLowerCase()==='prod'){b.trk_endpoint='https://sac.thesun.co.uk';}
b.trk_namespace='_ncg_nuk_';b.trk_appId='ncg-nuk';b.trk_sendAsPost='true';b.trk_cookieDomain='.thesun.co.uk';b.trk_cookieName='_nuk_sp_';b.trk_cookieLifetime='31536000';b.trk_platform='web';b.trk_encodeBase64='true';b.trk_respectDoNotTrack='false';b.trk_bufferSize='1';b.trk_storageStrategy='cookieAndLocalStorage';}}catch(e){utag.DB(e)}},function(a,b){try{if(1){b.trk_customPageURL='';b.trk_customPageTitle='';b.customer_id=(b.customer_id||'');b.customer_id=b.customer_id.toUpperCase();b.customer_id=b.customer_id.replace('CPN:','');b.user_provider='NewsUK';b.dmp_id=b['cp.permutive-id']||'';b.dmp_provider='Permutive';b.analytics_id=b['cp.utag_main_v_id']||'';b.analytics_provider='Tealium';b._ncg_g_id_='';if(b['cp._ncg_g_id_']&&b['cp._ncg_g_id_']!==''){try{b._ncg_g_id_=b['cp._ncg_g_id_'].toString();}
catch(e){b._ncg_g_id_='';}}
b.sync_vis_id='';try{b.sync_vis_id=document.cookie.match(/rc_id2=(.+?);/)[1].split('.').slice(-2).join(".");}catch(e){b.sync_vis_id='';}
b.sync_vis_provider='NewsUK Pixel';b.consentNewsIdData={"consentFramework":"unknown"};if(typeof b['cp.nukt_sp_consent_global']!=='undefined'){var t=b['cp.nukt_sp_consent_global'].toString().toUpperCase();if(t.indexOf('GDPR:')>-1&&t!=='GDPR:NOT YET KNOWN'){t=t.replace('GDPR:','');t=t.split('|');if(t.length==2){b.consentNewsIdData={"consentFramework":'gdpr',"purpose":{"consents":[],"legitimateInterests":[]},"vendor":{"consents":[],"legitimateInterests":[]}};t1="ABCDEFGHIJ".split('');for(i=0;i<t1.length;i++){b.consentNewsIdData.purpose.consents.push({"id":t1[i],"value":(t[0].indexOf(t1[i])>-1?true:false)});}
t1="NOPQRSTUV".split('');for(i=0;i<t1.length;i++){b.consentNewsIdData.purpose.legitimateInterests.push({"id":t1[i],"value":(t[1].indexOf(t1[i])>-1?true:false)});}
if(typeof b["cp.nukt_sp_vendors"]!=='undefined'){t=b["cp.nukt_sp_vendors"].toString().toUpperCase().split('|');for(i=0;i<t.length;i++){t1=t[i].split(',');if(t1.length===3&&/[0-9]+/.test(t1[0])&&(t1[1]==='TRUE'||t1[1]==='FALSE')&&(t1[2]==='TRUE'||t1[2]==='FALSE')){b.consentNewsIdData.vendor.consents.push({"id":t1[0],"value":(t1[1]==='TRUE'?true:false)});b.consentNewsIdData.vendor.legitimateInterests.push({"id":t1[0],"value":(t1[2]==='TRUE'?true:false)});}}}}}
else if(t.indexOf('CCPA:')>-1){b.consentNewsIdData={"consentFramework":'ccpa',"ccpaConsent":(t==='CCPA:ALLOWED'?true:false)};}
else if(b['cp.nukt_sp_consent_global'].toString().toUpperCase()==='NONE'){b.consentNewsIdData={"consentFramework":"none"};}}
b.consentNewsIdData=JSON.stringify(b.consentNewsIdData);}}catch(e){utag.DB(e)}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
u.loader_cb=function(){u.initialized=true;if(!u.spTrackerCreated){var trkConfig={};if(u.data.trk_appId){trkConfig.appId=u.data.trk_appId.toString();}
trkConfig.eventMethod='get';if(u.data.trk_sendAsPost){if(u.data.trk_sendAsPost.toString()==='true'){trkConfig.eventMethod='post';}}
if(u.data.trk_cookieDomain){trkConfig.cookieDomain=u.data.trk_cookieDomain.toString();}
if(u.data.trk_cookieName){trkConfig.cookieName=u.data.trk_cookieName.toString();}
if(u.data.trk_cookieLifetime){trkConfig.cookieLifetime=parseInt(u.data.trk_cookieLifetime.toString());}
if(u.data.trk_platform){trkConfig.platform=u.data.trk_platform.toString();}
trkConfig.encodeBase64=false;if(u.data.trk_encodeBase64){if(u.data.trk_encodeBase64.toString()==='true'){trkConfig.encodeBase64=true;}}
trkConfig.respectDoNotTrack=false;if(u.data.trk_respectDoNotTrack){if(u.data.trk_respectDoNotTrack.toString()==='true'){trkConfig.respectDoNotTrack=true;}}
if(u.data.trk_bufferSize){trkConfig.bufferSize=parseInt(u.data.trk_bufferSize);}
if(u.data.trk_storageStrategy){trkConfig.stateStorageStrategy=u.data.trk_storageStrategy.toString();}
trkConfig.anonymousTracking={withSessionTracking:true};trkConfig.contexts={webPage:true};window.nukNewsIdSnowplow('newTracker',u.data.trk_namespace.toString(),u.data.trk_endpoint.toString(),trkConfig);u.spTrackerCreated=true;}
if((typeof u.data.trk_customPageURL!=='undefined')&&u.data.trk_customPageURL!==''){window.nukNewsIdSnowplow('setCustomUrl',u.data.trk_customPageURL);}
var nc_article={},nc_aka={},nuk_c={},c1='',d1='',n1='';for(d in u.data){d1=d.toString().toLowerCase();if(d1.length>4){if(d1.substring(0,2)==='c.'){if(u.data[d]!==undefined&&u.data[d]!==null&&u.data[d].toString()!==''){c1=d1.substring(2,3);n1=d1.substring(4);if(c1==='n'){nuk_c[n1]=u.data[d].toString();}else if(c1==='a'){nc_article[n1]=u.data[d].toString();}else if(c1==='k'){nc_aka[n1]=u.data[d].toString();}}}}}
var cParams={"consentFramework":"unknown"};if(typeof u.data.consentData!=='undefined'){cParams=JSON.parse(u.data.consentData);}
var spParams={context:[{"schema":"iglu:com.newscgp/article/jsonschema/1-0-0","data":nc_article},{"schema":"iglu:com.newscgp/aka/jsonschema/1-0-2","data":nc_aka},{"schema":"iglu:com.newscgp/newsuk/jsonschema/1-0-1","data":nuk_c},{"schema":"iglu:com.newscgp/consent/jsonschema/1-0-0","data":cParams}]};if(a==='link'){spParams.category=((typeof u.data.trk_EventCategory!=='undefined')?u.data.trk_EventCategory.toString():'');spParams.action=((typeof u.data.trk_EventAction!=='undefined')?u.data.trk_EventAction.toString():'');spParams.label=((typeof u.data.trk_EventLabel!=='undefined')?u.data.trk_EventLabel.toString():'');spParams.property=((typeof u.data.trk_EventProperty!=='undefined')?u.data.trk_EventProperty.toString():'');spParams.vaue=0.0;}
if((typeof u.data.trk_customPageTitle!=='undefined')&&u.data.trk_customPageTitle!==''){spParams.title=u.data.trk_customPageTitle;}
if(a==='view'){window.nukNewsIdSnowplow('trackPageView',spParams);}else if(a==='link'){if(typeof u.data.trk_EventCategory!=='undefined'&&u.data.trk_EventCategory.toString()!==''&&typeof u.data.trk_EventAction!=='undefined'&&u.data.trk_EventAction.toString()!==''){window.nukNewsIdSnowplow('trackStructEvent',spParams);}}
}
if(!u.initialized){u.loader({"type":"script","src":u.data.trk_baseURL,"cb":u.loader_cb,"loc":"script","id":'utag_42'});}else{u.loader_cb();}
}};utag.o[loader].loader.LOAD(id);})("42","newsinternational.thesun.widgets");}catch(error){utag.DB(error);}
